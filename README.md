# 

本项目为 OpenSODA 大赛的 `T2：命令行交互的指标结果查询子模块` 的提交作品，该工具主要以 `Python` 实现，结果导出为 `.csv` 文件。

### 1. 工具设计



#### 输入
宏观上我们可以认为，工具的基本输入为 `指标名`，`仓库名` 以及 `时间范围`：
- `指标名`：若输入为 `all` 则查询目前 OpenDigger 支持的所有指标，因此实际上输入的指标应该为一个列表，可以为单一指标，也可以指定多个指标；
  - 除此之外，我们对 X-Lab 和 CHAOSS 指标做了分类，可输入 `x-all` 和 `c-all` 测试
- `时间范围`：时间范围有三种：
  - 闭区间：例如 `[2022-02, 2022-06]`
  - 单时间点：例如 `2022-06`
  - 离散时间点：例如 `(2022-02, 2022-05, 2021-09)`



#### 输出
- 基本的输出为 `.csv` 文件，其以输入的三个指标作为表头，详细描述了此次查询的报表；
- 命令行打印日志显示；
- 支持其他格式文件的输出，例如 `.html`。


![基本思想](png/queryowel-design.png)


### 2. 使用说明

1. 首先安装本项目运行所需的依赖
```python
pip install -r requirements.txt
```
2. 运行 `owel.py`，启动前输入的参数将作为全局缺省默认参数：
```python
python src/owel.py [--repo=] [--month=] [--metric=]
```
，将以默认参数执行

### 3. 使用示例
【示例 1】全局设置默认参数，后续在未输入具体值的选项会自动走全局值

```python
python owel.py --month="2022-02" --metric="openrank" --repo="lroethan"
Repository Name: 
Metric Name: 
Month: 

Repo.name = lroethan
+------------+------------+------------+
| Metric     | Month      | Value      |
+------------+------------+------------+
| openrank   | 2022-02    | No data    |
+------------+------------+------------+
```

【示例 2】使用泛化时间参数 `-`，将查询所有月份。
```python
Repository Name: lroethan
Metric Name: openrank
Month: -

```

【示例 3】使用泛化指标名，例如 `x-all`，`c-all`，`all`，使用离散时间点 `(2022-04, 2022-05, 2022-06）`
```python
Repository Name: lroethan
Metric Name: x-all
Month: (2022-04, 2022-05, 2022-06)

Repo.name = lroethan
+------------+------------+------------+
| Metric     | Month      | Value      |
+------------+------------+------------+
| openrank   | 2022-04    | 1.25       |
+------------+------------+------------+
| openrank   | 2022-05    | 1.1        |
+------------+------------+------------+
...
```
